<!DOCTYPE html>
<html lang="en">
    <html xmlns="w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"> 
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
            <link rel="stylesheet" th:href="@{/css/indexcss.css}" /> 
            <title>Empresa JK</title>
        </head>
        <body>
            <div class="col-12 col-md-12 Main">
                <div class="col-12 col-md-12 Banner">
                    <div class="Titulo">
                        <div class="col-8 col-md-8 d-flex " id="logo ">
                            <h1 class="display-2">JK</h1>
                            üí™<p class="text-secondary" id="descerAlinha">Sempre pensando no melhor para voc√™ e sua familia</p>
                        </div>
                        <img src="./Imagens/prop.PNG" class="img-fluid col-3 col-mb-3" alt="Propaganda">
                    </div>
                    <div class="text-center"><a href="https://buscacepinter.correios.com.br/app/endereco/index.php" class="text-secondary align-items-center text-decoration-none d-block"id="cep" >
                            üìå Informe seu <strong>Cep</strong>
                        </a></div>
                    <div class="col-12 col-md-12 justify-content-around Botoes">
                        <div class="col-10 col-md-10 TamanhoLetra">
                            <div class="col-12 col-md-12 Tamanho">
                                <div class="mb-12 d-flex botoesmenu"id="func" >Ver nossos Funcionarios</div>
                                <div class="mb-12 d-flex botoesmenu"id="entre">cadastrar funcionario</div>
                                <div class="mb-12 d-flex botoesmenu"id="excluir">excluir funcionario</div>
                                <div class="mb-12 d-flex botoesmenu"id="mostraCompra">Tabela Vendas</div>
                            </div>
                        </div>
                    </div>
                    <div class="cadastro">
                        <form class="meu-form-oculto" >

                            <div class="col-md-10 col-10 d-flex align-items-center justify-content-between flex-column mt-3">
                                <h2 class=" d-flex justify-content-around">cadastrar funcionario</h2>
                                    <div class="d-flex flex-column border p-3">
                                        <label>nome:</label>
                                        <input type="text" name="nome" id="cadFunc" required>
                                        <div class="botaoAdc" type="submit">contratar</div>
                                    </div>
                                </div>
                        </form>
                    </div>
                    <div class="excluirFuncionario">
                        <form class="meu-form-oculto">
                            <div class="col-md-10 col-10 d-flex align-items-center justify-content-between flex-column mt-3">
                                <h2 class=" d-flex justify-content-around"> deletar funcionario</h2>
                                    <div class="d-flex flex-column border p-3">
                                        <label>nome:</label>
                                        <input id="nomeDel" type="text" name="nome" required>
                                        <div class="botaoDeleta" type="submit">excluir</div>
                                    </div>
                            </div>
                        </form>
                    </div>
                    <div class="mostraFunc">
                        <form class="meu-form-oculto">
                         <h2 class=" d-flex justify-content-around">Funcionarios</h2>
                            <div th:each="funcionario : ${funcionario}">
                                <div class="d-flex justify-content-evenly align-items-center Border border">
                                    <div class="d-flex justify-content-between" id="Whid">
                                        <p class="nomeClientes" th:text="${funcionario.nome}"></p>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
                        <form class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="deleteModalLabel">Resultado</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body" id="deleteModalBody">
                                </div>
                                <button class="btn btn-primary mt-3" type="submit">fechar</button>  
                            </div>
                        </form>
                    </div>
                    <div class="mostraVendas">
                        <form th:action="@{/modalCliente}" method="get">
                            <h2 class=" d-flex justify-content-around">Clientes</h2>

                            <div th:each="cliente : ${clientes}">
                                <div class="d-flex justify-content-evenly align-items-center Border border">
                                    <div class="d-flex justify-content-between" id="Whid">
                                        <p class="nomeClientes" th:text="${cliente.nome}"></p>
                                        <div type="submit" class="botao" name="nome" th:value="${cliente.nome}" data-bs-toggle="modal" data-bs-target="#modalDetalhesCliente">
                                            compras üè¨
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>

                    <div class="modal fade" id="modalDetalhesCliente" tabindex="-1" aria-labelledby="modalDetalhesClienteLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="modalDetalhesClienteLabel">Detalhes do Cliente</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="text-center" id="Detalhes"></div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-indicators">
                            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
                            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
                        </div>
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img src="./Imagens/perfume.PNG" class="d-block w-100" alt="...">
                                <div class="carousel-caption d-none d-md-block">
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="./Imagens/Black.PNG" class="d-block w-100" alt="...">
                                <div class="carousel-caption d-none d-md-block">

                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="./Imagens/cerveja.PNG" class="d-block w-100" alt="...">
                                <div class="carousel-caption d-none d-md-block">

                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="./Imagens/liquida.PNG" class="d-block w-100" alt="...">
                                <div class="carousel-caption d-none d-md-block">

                                </div>
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    </div>
                    <div class="col-10 col-md-12 d-flex container">
                        <div class="col-12 col-md-12 d-flex flex-md-row flex-column" id="Borda">
                            <div class="bg-primary PagamentoRapido"> &nbsp;</div>
                            <Div class="SemJuros" >
                                <h5>Pagamento Rapido e seguro</h5>   
                                <p class="text-secondary">Com mercado Pago</p>
                            </Div>

                            <div class="pl-0 d-flex align-items-center" id="Border">
                                <img decoding="async" src="https://http2.mlstatic.com/storage/homes-korriban/assets/images/payments/credit-card.svg" alt="At√© 10x sem juros" style="margin-right: 10px;">
                                <div>
                                    <h5>Em at√© 10x sem juros</h5>   

                                </div>
                            </div>
                            <div id="Border" class="d-flex align-items-center">
                                <img decoding="async" src="https://http2.mlstatic.com/storage/homes-korriban/assets/images/payments/mercado-creditsv2.svg" alt="Parcelamento sem cart√£o" style="margin-right: 10px;">
                                <div>
                                    <h5>Parcelamento sem cart√£o</h5>   
                                </div>
                            </div>

                            <div class="col-2 d-flex align-items-center" id="Border">
                                <img decoding="async" src="https://http2.mlstatic.com/storage/homes-korriban/assets/images/payments/qr.svg" alt="Via Pix"style="margin-right: 10px;">
                                <div>
                                    <h5>Via pix</h5>   
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-10 col-md-12 container">
                        <div class="Separa">
                            <h3>Ofertas do dia  <div id="DiminuiTexto">Ver todas</div>  </h3>
                        </div>
                    </div>

                    <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
                        <div class="col-10 col-md-12 container">
                            <div class="carousel-indicators">
                                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
                                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
                            </div>
                            <div class="col-10 col-md-12">
                                <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <div class="col-12 d-flex justify-content-between align-items-center">
                                                <img src="./Imagens/noot.PNG" class="img-fluid mb-3" alt="...">

                                                <img src="./Imagens/creatina.PNG" class="img-fluid mb-3" alt="...">
                                                <img src="./Imagens/geladeira.PNG" class="img-fluid mb-3" alt="...">
                                                <img src="./Imagens/fritadeira.PNG" class="img-fluid mb-3" alt="...">

                                            </div>
                                            <div class="carousel-caption d-none d-md-block"></div>
                                        </div>
                                        <div class="carousel-item">
                                            <div class="col-12 col-md-12 d-flex justify-content-around align-items-center">
                                                <img src="./Imagens/noot.PNG" class="img-fluid mb-3" alt="...">
                                                <img src="./Imagens/creatina.PNG" class="img-fluid mb-3" alt="...">

                                                <img src="./Imagens/geladeira.PNG" class="img-fluid mb-3" alt="...">

                                                <img src="./Imagens/fritadeira.PNG" class="img-fluid mb-3" alt="...">
                                            </div>
                                            <div class="carousel-caption d-none d-md-block"></div>
                                        </div>
                                        <div class="carousel-item">
                                            <div class="col-12 col-md-12 d-flex justify-content-around align-items-center">
                                                <img src="./Imagens/noot.PNG" class="img-fluid mb-3" alt="...">

                                                <img src="./Imagens/creatina.PNG" class="img-fluid mb-3" alt="...">

                                                <img src="./Imagens/geladeira.PNG" class="img-fluid mb-3" alt="...">

                                                <img src="./Imagens/fritadeira.PNG" class="img-fluid mb-3" alt="...">
                                            </div>
                                            <div class="carousel-caption d-none d-md-block"></div>
                                        </div>
                                        <div class="carousel-item">
                                            <div class="col-12 col-md-12 d-flex justify-content-around align-items-center">
                                                <img src="./Imagens/noot.PNG" class="img-fluid mb-3" alt="...">

                                                <img src="./Imagens/creatina.PNG" class="img-fluid mb-3" alt="...">

                                                <img src="./Imagens/geladeira.PNG" class="img-fluid mb-3" alt="...">

                                                <img src="./Imagens/fritadeira.PNG" class="img-fluid mb-3" alt="...">

                                            </div>
                                            <div class="carousel-caption d-none d-md-block"></div>
                                        </div>
                                    </div>
                                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Previous</span>
                                    </button>
                                    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Next</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-10 col-md-12 container">
                        <div class="col-12 col-md-12">

                            <div class="col-12 col-md-12 RowContainer ">
                                <div class="Meli border w-100 d-flex justify-content-between text-white">
                                    <h4>Assine o Meli + Por um pre√ßo promocional</h4>
                                    <h4>R$ 9,90</h4>
                                </div>
                                <div class="mt-3">
                                    <strong> Conte com os melhores benef√≠cios no Mercado Livre e do Mercado Pago</strong>
                                </div>
                                <div class="w-100">
                                    <ul class="Lista">
                                        <li class="mb-12 d-flex align-items-center flex-md-row flex-column">
                                            <img decoding="async" src="https://http2.mlstatic.com/resources/frontend/statics/loyal/v2/truckgiftv4@2x.png" class="img-fluid mb-2" alt="">
                                            Frete gr√°tis em milh√µes de produtos a partir de R$ 29
                                        </li>

                                        <li class="mb-12 d-flex align-items-center flex-md-row flex-column">
                                            <img decoding="async" src="https://http2.mlstatic.com/resources/frontend/statics/loyal/partners/disneyplus/widget-home/combo-widgetl6@2x.jpg" class="img-fluid mb-2" alt="">
                                            Disney+ e Star+ sem custo
                                        </li>

                                        <li class="mb-12 d-flex align-items-center flex-md-row flex-column">
                                            <img decoding="async" src="https://http2.mlstatic.com/resources/frontend/statics/loyal/partners/deezer/rebranding/deezer-logo-circle-vdp-filled@3x.png" class="img-fluid mb-2" alt="">
                                            Deezer Premium 12 meses sem custo
                                        </li>

                                        <li class="mb-12 d-flex align-items-center flex-md-row flex-column">
                                            <img decoding="async" src="https://http2.mlstatic.com/resources/frontend/statics/loyal/ultrapasse-widget@2x.png" class="img-fluid mb-2" alt="">
                                            60% OFF no Ultrapasse e outros benef√≠cios
                                        </li>
                                    </ul>
                                    <div class="d-flex py-3 flex-row-reverse Border border-top ">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-12 container">
                        <div class="col-12 col-md-12 pt-4">
                            <div class="row Border border align-items-center justify-content-between bg-white vendas " >
                                <h2 class="d-flex justify-content-center"> clique sobre as compras que deseja realizar</h2>
                                <div class="row">
                                    <div th:each="item : ${estoque}" class="col-sm-6 col-md-2 mb-12 d-flex flex-column justify-content-around align-items-center Hov minhaDiv" 
                                         th:name=${item.nome} th:data-valor=${item.valor}>
                                        <img th:src="${item.imagens}" class="img-fluid mb-2 img-custom-size" alt="">
                                        <div class="text-center" th:text="${item.nome} + ' R$:' + ${item.valor}"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="container mx-auto text-center">
                                <div class="col-12 col-md-12 d-flex justify-content-center pt-20">
                                    <div class="col-12 col-mb-12 venda" id="compras">
                                        <form class="col-12 mb-12 d-grid justify-content-center Border border"th:action="@{/compra}" method="post">
                                            <label>nome do cliente</label>
                                            <input type="text" id="nome" name="nome" required>
                                            <div class="textArea w-30 h-50"name="produto_valor"></div>
                                            <input type="hidden" id="produtosInput" name="produtos" />
                                            <textarea class="valorTotal" name="valorTotal"></textarea>
                                            <div class="d-flex justify-content-center">
                                                <button class="btn btn-primary mt-3"id="BotaoCompra" type="submit">Enviar</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
            <script th:src="@{/js/jquery.js}"></script>
            <script th:inline="javascript">
                document.addEventListener('DOMContentLoaded', function () {
                    var myCarousel = new bootstrap.Carousel(document.querySelector('#carouselExampleCaptions'));
                });
            </script>
            <script th:inline="javascript">
                $(".botao").click(function () {
                    var compras = []; // Inicializa o array corretamente
                    var clienteNome = $(this).closest('.d-flex').find('.nomeClientes').text();
                    $.ajax({
                        url: '/Busca',
                        method: 'GET',
                        data: {nome: clienteNome},
                        dataType: 'json',
                        success: function (response) {
                            console.log(response);
                            $('#tabelaVendas tbody').empty(); // Limpa o conte√∫do atual da tabela
                            $.each(response, function (index, venda) {
                                compras.push(venda.estoque.nome + ": R$ " + venda.estoque.valor); // Adiciona cada compra ao array
                            });
                            console.log(compras);
                            $("#Detalhes").html(compras.join("<br>"));
                            $('#modalDetalhesCliente').modal({
                                backdrop: 'static', keyboard: false});

                        },
                        error: function () {
                            console.error("Erro ao buscar vendas do cliente.");
                        }
                    });
                });

                $(document).ready(function () {
                    var totalSoma = 0;
                    var produtos = [];
                    var nomesProduto = [];

                    $(".minhaDiv").click(function () {
                        var valor = parseInt($(this).data("valor"));
                        totalSoma += valor;
                        var nomeObjeto = $(this).attr("name");
                        nomesProduto.push(nomeObjeto);
                        produtos.push(nomeObjeto + ":" + valor);
                        $(".textArea").html(produtos.join("<br>"));
                        $('.valorTotal').val(totalSoma.toFixed(2));
                        $('#produtosInput').val(nomesProduto.join(","));
                    });

                    $("#BotaoCompra").click(function ()
                    {
                        var cliente = $("#nome").val();
                        if (cliente)
                        {
                            produtos = [];
                            $("#compras").hide();
                            totalSoma = 0;
                            alert("Compra efetuada com sucesso!");
                        }
                    });
                }
                );
                const Fechar = () => {
                    $('.cadastro').css({"display": "none"});
                    $('.excluirFuncionario').css({"display": "none"});
                    $('.mostraVendas').css({"display": "none"});
                    $('.mostraFunc').css({"display": "none"});
                }
                $(document).ready(function () {
                    $('.venda').hide();
                    $(".img-custom-size").click(function () {
                        $('#compras').css({"display": "block"});
                        console.log("cliques");
                    });
                });

                function fecharAbrir(classe, id) {
                    var contadorCliques = 0;

                    $(id).click(function () {
                        contadorCliques++;
                        if (contadorCliques % 2 === 1) {
                            Fechar();
                            $(classe).css({"display": "block"});
                        } else {
                            $(classe).hide();
                        }
                    });
                }
                $(document).ready(function () {
                    $(".cadastro").hide();
                    fecharAbrir('.cadastro', "#entre");
                });
                $(document).ready(function () {
                    $('.excluirFuncionario').hide();
                    fecharAbrir('.excluirFuncionario', "#excluir");
                });

                $(document).ready(function () {
                    $('.mostraVendas').hide();
                    fecharAbrir('.mostraVendas', "#mostraCompra");
                });

                $(document).ready(function () {
                    $('.mostraFunc').hide();
                    fecharAbrir('.mostraFunc', "#func");
                });

                $(function () {
                    $(".botaoDeleta").click(function () {
                        var nomeFuncionario = $('#nomeDel').val();
                        if(nomeFuncionario <2)
                        {
                               alert("Por favor digite um nome com no minimo 3 caracteres");
                        }   
                        else
                        {
                        $.ajax({
                            url: '/deletar',
                            method: 'DELETE',
                            data: {nome: nomeFuncionario},
                            success: function (response) {
                                console.log(response);
                                $('#deleteModalBody').text(response);
                                $('#deleteModal').modal({backdrop: 'static', keyboard: false}).modal('show');
                            },
                            error: function () {
                                $('#deleteModalBody').text("Erro ao excluir o funcion√°rio.");
                                $('#deleteModal').modal('show');

                            }
                        });
                    }});
                });

                $(".botaoAdc").click(function () {
                    var nomeFuncionario = $('#cadFunc').val();
                    if(nomeFuncionario<2)
                    {
                        alert("Digite um nome maior ou um nome Valido por favor");
                    }else{
                    $.ajax({
                        url: '/adcionar',
                        method: 'POST',
                        data: {nome: nomeFuncionario},
                        success: function (response) {
                            console.log(response);
                            $('#deleteModalBody').text(response);
                            $('#deleteModal').modal({backdrop: 'static', keyboard: false}).modal('show');

                        },
                        error: function () {
                            $('#deleteModalBody').text("Funcionario ja adcionado.");
                        }
                    });
                    }});


            </script>

        </body>
    </html>

